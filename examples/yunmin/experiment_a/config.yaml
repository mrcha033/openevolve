# Track selection is via AI_OPT_TRACK env var (baseline|gpt5|profiler|gpt5_profiler).
# LLM api_base and model are overridden by run_track.sh CLI flags.
max_iterations: 50
checkpoint_interval: 10
parallel_evaluations: 1
language: cpp
diff_based_evolution: true
max_code_length: 200000

llm:
  api_base: "http://127.0.0.1:8000/v1"  # default; overridden by --api-base
  models:
    - name: "local-model"  # default; overridden by --primary-model
      weight: 1.0
  temperature: 0.5
  max_tokens: 8000
  timeout: 180

database:
  population_size: 30
  num_islands: 2
  migration_interval: 10
  feature_dimensions:
    - "ops_per_sec"
    - "p99_latency_us"

evaluator:
  timeout: 900
  max_retries: 1

prompt:
  system_message: |
    You are a C++ performance optimization expert working on RocksDB internals.
    Your task is to optimize the WAL (Write-Ahead Log) write path by modifying
    the DBImpl::WriteImpl() function.

    You are viewing a FUNCTION SLICE extracted from db/db_impl/db_impl_write.cc.
    This is the complete function â€” modify any part of it freely.

    Key types and APIs used in this function:
    - WriteOptions: contains sync (bool), disableWAL, no_slowdown, low_pri
    - WriteBatch: batch of KV writes; Count() returns number of ops
    - WriteThread::Writer: per-writer state; linked into write_thread_ group
    - WriteThread::WriteGroup: batch of Writers committed together
    - write_thread_.EnterAsBatchGroupLeader / ExitAsBatchGroupLeader: group commit coordination
    - WriteBatchInternal::Append / SetSequence / Count: batch manipulation
    - WriteToWAL(): writes batch to WAL log file
    - MarkLogsSynced() / SyncWAL(): WAL durability
    - versions_->SetLastSequence(): sequence number advancement
    - FlushMemTable triggers based on write_buffer_manager_

    Optimization strategies:
    - Reduce WAL sync overhead (batch syncs, group commits)
    - Minimize lock hold time in the write path
    - Improve write buffer management
    - Reduce unnecessary copies or allocations

    Constraints:
    - C++17 only
    - Preserve ACID semantics and WAL durability guarantees
    - Changes must compile with the existing RocksDB build system
  num_top_programs: 3
  num_diverse_programs: 2

log_level: "INFO"
